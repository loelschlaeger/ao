<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="ao">
<title>Alternating optimization • ao</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Alternating optimization">
<meta property="og:description" content="ao">
<meta property="og:image" content="https://loelschlaeger.de/ao/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ao</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.6.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/ao.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/loelschlaeger/ao/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Alternating optimization</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/loelschlaeger/ao/blob/HEAD/vignettes/ao.Rmd" class="external-link"><code>vignettes/ao.Rmd</code></a></small>
      <div class="d-none name"><code>ao.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="background">Background<a class="anchor" aria-label="anchor" href="#background"></a>
</h2>
<div class="section level3">
<h3 id="what-is-alternating-optimization">What is alternating optimization?<a class="anchor" aria-label="anchor" href="#what-is-alternating-optimization"></a>
</h3>
<p>Alternating optimization is an iterative procedure for optimizing
some function jointly over all parameters by alternating restricted
optimization over individual parameter subsets.</p>
<p>More precisely, consider minimizing or maximizing <span class="math inline">\(f:\mathbb{R}^n \to \mathbb{R}\)</span> over the
set of feasible points <span class="math inline">\(x \in X \subseteq
\mathbb{R}^n\)</span>. The underlying algorithm of alternating
optimization is as follows:</p>
<ol style="list-style-type: decimal">
<li><p>Assign an initial value for <span class="math inline">\(x\)</span>.</p></li>
<li><p>Optimize <span class="math inline">\(f\)</span> with respect to a
subset of parameters <span class="math inline">\(\tilde{x}\)</span>
while holding the other parameters constant. Note that alternating
optimization is a generalization of joint optimization, where the only
parameter subset would be the whole set of parameters.</p></li>
<li><p>Replace the values in <span class="math inline">\(x\)</span> by
the optimal values for <span class="math inline">\(\tilde{x}\)</span>
found in step 2.</p></li>
<li><p>Repeat from step 2 with another parameter subset.</p></li>
<li><p>Stop when the process has converged or reached the iteration
limit.</p></li>
</ol>
</div>
<div class="section level3">
<h3 id="when-is-alternating-optimization-a-good-idea">When is alternating optimization a good idea?<a class="anchor" aria-label="anchor" href="#when-is-alternating-optimization-a-good-idea"></a>
</h3>
<ul>
<li><p>When the joint optimization is numerically difficult or not
feasible.</p></li>
<li><p>When there is a natural division of the parameters. That is the
case for likelihood functions, where the parameter space naturally
divides into parameter subsets, e.g. corresponding to linear effects,
variances and covariances with different influence on the likelihood
value.</p></li>
<li><p>To improve optimization time in some cases, see <span class="citation">(<a href="#ref-hu:2002" role="doc-biblioref">Hu and
Hathaway 2002</a>)</span> for an example.</p></li>
<li><p>Compared to joint optimization, alternating optimization may be
better in bypassing local optima, see <span class="citation">(<a href="#ref-bezdek:2002" role="doc-biblioref">James C. Bezdek and
Hathaway 2002</a>)</span>.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="what-are-the-properties-of-alternating-optimization">What are the properties of alternating optimization?<a class="anchor" aria-label="anchor" href="#what-are-the-properties-of-alternating-optimization"></a>
</h3>
<p>Alternating optimization under certain conditions on <span class="math inline">\(f\)</span> can convergence to the global optimum.
However, the set of possible solutions also contains saddle points <span class="citation">(<a href="#ref-bezdek:1987" role="doc-biblioref">James
C. Bezdek et al. 1987</a>)</span>. <span class="citation">J. Bezdek and
Hathaway (<a href="#ref-bezdek:2003" role="doc-biblioref">2003</a>)</span> provides additional details on the
convergence rate.</p>
</div>
</div>
<div class="section level2">
<h2 id="application">Application<a class="anchor" aria-label="anchor" href="#application"></a>
</h2>
<p>As an application, we consider minimizing the <a href="https://en.wikipedia.org/wiki/Himmelblau%27s_function" class="external-link">Himmelblau’s
function</a> in <span class="math inline">\(n = 2\)</span> dimensions
with parameter constraints <span class="math inline">\(-5 \leq x_1, x_2
\leq 5\)</span>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://loelschlaeger.de/ao/">"ao"</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: optimizeR</span></span>
<span><span class="co">#&gt; Thanks for using {optimizeR} 0.3.2.</span></span>
<span><span class="va">himmelblau</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="fl">11</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">x</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">^</span><span class="fl">2</span> <span class="op">-</span> <span class="fl">7</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span></span>
<span><span class="fu"><a href="../reference/ao.html">ao</a></span><span class="op">(</span>f <span class="op">=</span> <span class="va">himmelblau</span>, p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span>, partition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span>   base_optimizer <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/optimizeR/man/define_optimizer.html" class="external-link">optimizer_optim</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, upper <span class="op">=</span> <span class="fl">5</span>, method <span class="op">=</span> <span class="st">"L-BFGS-B"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $value</span></span>
<span><span class="co">#&gt; [1] 1.940035e-12</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $estimate</span></span>
<span><span class="co">#&gt; [1]  3.584428 -1.848126</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sequence</span></span>
<span><span class="co">#&gt;    iteration partition        value      seconds       p1        p2</span></span>
<span><span class="co">#&gt; 1          0        NA 1.700000e+02 0.0000000000 0.000000  0.000000</span></span>
<span><span class="co">#&gt; 2          1         1 1.327270e+01 0.0063288212 3.395691  0.000000</span></span>
<span><span class="co">#&gt; 3          1         2 1.743666e+00 0.0002534389 3.395691 -1.803183</span></span>
<span><span class="co">#&gt; 4          2         1 2.847292e-02 0.0002150536 3.581412 -1.803183</span></span>
<span><span class="co">#&gt; 5          2         2 4.687472e-04 0.0001699924 3.581412 -1.847412</span></span>
<span><span class="co">#&gt; 6          3         1 7.368063e-06 0.0002567768 3.584381 -1.847412</span></span>
<span><span class="co">#&gt; 7          3         2 1.157612e-07 0.0001335144 3.584381 -1.848115</span></span>
<span><span class="co">#&gt; 8          4         1 1.900153e-09 0.0001320839 3.584427 -1.848115</span></span>
<span><span class="co">#&gt; 9          4         2 4.221429e-11 0.0001118183 3.584427 -1.848126</span></span>
<span><span class="co">#&gt; 10         5         1 3.598278e-12 0.0002264977 3.584428 -1.848126</span></span>
<span><span class="co">#&gt; 11         5         2 1.940035e-12 0.0001497269 3.584428 -1.848126</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $seconds</span></span>
<span><span class="co">#&gt; [1] 0.007977724</span></span></code></pre></div>
<p>The call minimizes <code>f</code> by alternating optimizing with
respect to each parameter separately, where the parameters all are
initialized at the value 0.</p>
<div class="r-help-page">
<div class="container">

<table style="width: 100%;" class="table"><tr>
<td>ao</td>
<td style="text-align: right;">R Documentation</td>
</tr></table>
<h2 id="ao">Alternating Optimization</h2>

<h3>Arguments</h3>

<table class="table">
<tr>
<td><code id="ao_:_f">f</code></td>
<td>
<p>A <code>function</code> to be optimized, returning a single <code>numeric</code>.
The first argument of <code>f</code> must be a <code>numeric</code> of the same length as
<code>p</code> followed by any other arguments specified by the <code>...</code>
argument.</p>
</td>
</tr>
<tr>
<td><code id="ao_:_p">p</code></td>
<td>
<p>A <code>numeric</code> vector, the starting parameter values for the optimization.</p>
</td>
</tr>
<tr>
<td><code id="ao_:_...">...</code></td>
<td>
<p>Additional arguments to be passed to <code>f</code>.</p>
</td>
</tr>
<tr>
<td><code id="ao_:_partition">partition</code></td>
<td>
<p>A <code>list</code> of vectors of indices of <code>p</code>, specifying the partition in
the alternating optimization process.
The default is <code>as.list(1:length(p))</code>, i.e. each parameter is
optimized separately.
Parameter indices can be members of multiple subsets.</p>
</td>
</tr>
<tr>
<td><code id="ao_:_base_optimizer">base_optimizer</code></td>
<td>
<p>An <code>optimizer</code> object, which can be specified via
<code>define_optimizer</code>.
It numerically solves the optimization problems in the partitions.
The default optimizer is <code>optimizer_optim</code>.</p>
</td>
</tr>
<tr>
<td><code id="ao_:_iterations">iterations</code></td>
<td>
<p>An <code>integer</code>, the maximum number of iterations through
<code>partitions</code> before the alternating optimization process is terminated.
Can also be <code>Inf</code>, in which case <code>tolerance</code> is responsible for the
termination.
The default is <code>10</code>.</p>
</td>
</tr>
<tr>
<td><code id="ao_:_tolerance">tolerance</code></td>
<td>
<p>A non-negative <code>numeric</code>. The alternating optimization terminates
prematurely (i.e., before <code>interations</code> is reached) if the euclidean
distance between the current estimate and the one from the last iteration is
smaller than <code>tolerance</code>.
The default is <code>1e-6</code>.</p>
</td>
</tr>
<tr>
<td><code id="ao_:_f_partition">f_partition</code></td>
<td>
<p>A <code>list</code> of the same length as <code>partition</code>.
The <code>i</code>-th element can be a <code>function</code> that computes the value of
<code>f</code> for the <code>i</code>-th parameter set defined in <code>partition</code>.
The <code>function</code> must be of the form
<code>function(theta_part, theta_rest, ...)</code>, where
</p>

<ul>
<li> <p><code>theta_part</code> receives the parameter set for the current partition
(this argument can be named differently),
</p>
</li>
<li> <p><code>theta_rest</code> receives the remaining parameters
(this argument must be named <code>theta_rest</code>),
</p>
</li>
<li> <p><code>...</code> receives the additional arguments to <code>f</code>.
Alternatively, it can be <code>NULL</code>, in which case <code>f</code> is used.
</p>
</li>
</ul>
</td>
</tr>
<tr>
<td><code id="ao_:_joint_end">joint_end</code></td>
<td>
<p>If <code>TRUE</code>, the parameter set is optimized jointly after the alternating
optimization process is terminated.
The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr>
<td><code id="ao_:_verbose">verbose</code></td>
<td>
<p>If <code>TRUE</code>, full tracing details are printed during the alternating
optimization process.
The default is <code>FALSE</code>.</p>
</td>
</tr>
<tr>
<td><code id="ao_:_plot">plot</code></td>
<td>
<p>If <code>TRUE</code>, parameter updates are plotted during the alternating
optimization process.
The default is <code>FALSE</code>.</p>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-bezdek:2002" class="csl-entry">
Bezdek, James C., and Richard J. Hathaway. 2002. <span>“Some Notes on
Alternating Optimization.”</span> <em>Proceedings of the 2002 AFSS
International Conference on Fuzzy Systems. Calcutta: Advances in Soft
Computing</em>. <a href="https://doi.org/10.1007/3-540-45631-7_39" class="external-link">https://doi.org/10.1007/3-540-45631-7_39</a>.
</div>
<div id="ref-bezdek:1987" class="csl-entry">
Bezdek, James C, Richard J Hathaway, Michael J Sabin, and William T
Tucker. 1987. <span>“Convergence Theory for Fuzzy c-Means:
Counterexamples and Repairs.”</span> <em>IEEE Transactions on Systems,
Man, and Cybernetics</em> 17 (5): 873–77. <a href="https://doi.org/10.1109/TSMC.1987.6499296" class="external-link">https://doi.org/10.1109/TSMC.1987.6499296</a>.
</div>
<div id="ref-bezdek:2003" class="csl-entry">
Bezdek, James, and Richard Hathaway. 2003. <span>“Convergence of
Alternating Optimization.”</span> <em>Neural, Parallel and Scientific
Computations</em> 11 (December): 351–68.
</div>
<div id="ref-hu:2002" class="csl-entry">
Hu, Yingkang, and Richard J Hathaway. 2002. <span>“On Efficiency of
Optimization in Fuzzy c-Means.”</span> <em>Neural, Parallel and
Scientific Computations</em> 10.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://loelschlaeger.de" class="external-link">Lennart Oelschläger</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
